# CVE-2021-25324

## Description

The MISP Project threat sharing platform is vulnerable to Stored Cross Site
Scripting attack. It allows users to embed an arbitrary JS code in the Galaxy
Cluster view.

## Severity

High

## Exploitability

Even though the basic low privileged user roles (Read Only, Publisher) are not
capable to edit Galaxies, this issue can exploit an attacker (e.g malicious
admin) of a different organization who can share "malicious Galaxy Cluster"
between MISP communities. Therefore, a possibility exists to become a victim of
an attack originated from a different organization.


## Technical Details

An issue was discovered in Galaxy Cluster Add & Edit forms:
- Add Galaxy Cluster: `https://misp.local/galaxy_clusters/add/{galaxy_id}`
- Edit Galaxy Cluster: `https://misp.local/galaxy_clusters/edit/{galaxy_cluster_id}`

Affected form input: `GalaxyClusterValue` (Name)

Submitting malicious Galaxy Cluster name via listed forms doesn't have to be
the only way how to exploit the vulnerability and achieve JS code execution.
Most likely there are other ways how to submit malicious `GalaxyClusterValue`
into the application, e.g by Import functionality. Thus it is required to
validate the `GalaxyClusterValue` field on all places in the source code.

## Resolution

The fix is distributed as a part of the MISP 2.4.137 update.

## Reporter

This vulnerability was discovered by Daniel Kubica.

## Disclosure Timeline

- 19 January 2021 — Issue reported to vendor
- 19 January 2021 — Vendor responded and confirmed the issue
- 19 January 2021 — Vendor shared a source code changes with addressed issue.
- 20 January 2021 — Vendor released fixed product version.

## References

- https://www.misp-project.org/2021/01/20/MISP.2.4.137.released.html
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25324
