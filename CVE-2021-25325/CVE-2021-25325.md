# CVE-2021-25325

## Description

The MISP Project threat sharing platform is vulnerable to Stored Cross Site
Scripting attack. Application allows to add Galaxy Cluster Element reference
which is not properly validated.

## Severity

Medium

## Exploitability

The reference type Galaxy Cluster Elements are automatically converted to
links. This can be exploited by an attacker who can create references
represented by specially crafted malicious links. When a user is tricked into
clicking on a malicious link embedded JS code will execute in the user's
browser.

## Technical Details

An issue was discovered in Galaxy Cluster Elements Edit form:

- Edit Galaxy Cluster:  `https://misp.local/galaxy_clusters/edit/{galaxy_cluster_id}`

Editing the Galaxy Cluster `refs` type element doesn't have to be the only way
how to exploit this vulnerability. Most likely there are other ways how to
submit malicious `refs` value into application, e.g. by Import functionality.
Therefore it is required to validate `refs` type elements on all places in the
source code.

## Resolution

The fix is distributed as a part of the MISP 2.4.137 update.

## Reporter

This vulnerability was discovered by Daniel Kubica.

## Disclosure Timeline

- 19 January 2021 — Issue reported to vendor
- 19 January 2021 — Vendor responded and confirmed the issue
- 19 January 2021 — Vendor shared a source code changes with addressed issue.
- 20 January 2021 — Vendor released fixed product version.

## References

- https://www.misp-project.org/2021/01/20/MISP.2.4.137.released.html
- https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25325
